---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';

export async function getStaticPaths() {
	const writeups = await getCollection('writeups', ({ data }) => data.status === 'published');
	return writeups.map((entry) => ({
		params: { slug: entry.slug },
		props: { entry },
	}));
}

const { entry } = Astro.props;
const { Content } = await entry.render();
const formattedDate = entry.data.date
	? new Intl.DateTimeFormat('en-US', {
			month: 'long',
			day: 'numeric',
			year: 'numeric',
		}).format(entry.data.date)
	: 'Undated';
---

<BaseLayout title={entry.data.title} description={entry.data.description}>
	<section class="hero">
		<div>
			<h1 class="hero__title">{entry.data.title}</h1>
			<p class="hero__subtitle">{entry.data.description}</p>
			<p class="card__meta">{formattedDate}</p>
		</div>
	</section>

	<article class="entry">
		<Content />
	</article>

	<style>
		.entry {
			background: rgba(6, 18, 13, 0.85);
			border-radius: 18px;
			padding: 28px;
			box-shadow: var(--shadow);
			border: 1px solid rgba(41, 255, 143, 0.12);
			line-height: 1.7;
			font-size: 1.02rem;
		}

		:global(.entry h2),
		:global(.entry h3) {
			font-family: 'Space Mono', 'IBM Plex Mono', monospace;
			margin-top: 1.8rem;
		}

		:global(.entry a) {
			color: var(--accent);
			text-decoration: underline;
			text-decoration-thickness: 2px;
			text-underline-offset: 3px;
		}

		:global(.entry ul) {
			padding-left: 1.3rem;
		}

		:global(.entry code) {
			background: rgba(41, 255, 143, 0.12);
			padding: 0.15rem 0.35rem;
			border-radius: 6px;
		}

		:global(.entry pre) {
			background: rgba(4, 12, 9, 0.95);
			border-radius: 12px;
			padding: 16px 18px;
			border: 1px solid rgba(41, 255, 143, 0.18);
			box-shadow: inset 0 0 0 1px rgba(8, 28, 19, 0.6);
			overflow-x: auto;
			margin: 1.4rem 0;
		}

		:global(.entry pre code) {
			display: block;
			background: transparent;
			padding: 0;
			color: #d6f7e4;
			font-size: 0.95rem;
			line-height: 1.6;
		}

		:global(.entry blockquote) {
			margin: 1.4rem 0;
			padding: 0.9rem 1.1rem;
			border-left: 3px solid var(--accent);
			background: rgba(9, 26, 18, 0.7);
			border-radius: 10px;
			color: var(--ink-soft);
			box-shadow: inset 0 0 0 1px rgba(41, 255, 143, 0.14);
		}

		:global(.entry blockquote p) {
			margin: 0;
		}
	</style>
</BaseLayout>
